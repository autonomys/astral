query AccountsTopLeaderboard(
  $whereFarmerBlockTotalCounts: leaderboard_farmer_block_total_counts_bool_exp
  $whereOperatorDepositsTotalValues: leaderboard_operator_deposits_total_values_bool_exp
  $whereNominatorDepositsTotalValues: leaderboard_nominator_deposits_total_values_bool_exp
) {
  leaderboard_farmer_block_total_counts(
    order_by: { rank: asc }
    where: $whereFarmerBlockTotalCounts
    limit: 1
  ) {
    rank
  }
  leaderboard_operator_deposits_total_values(
    order_by: { rank: asc }
    where: $whereOperatorDepositsTotalValues
    limit: 1
  ) {
    rank
  }
  leaderboard_nominator_deposits_total_values(
    order_by: { rank: asc }
    where: $whereNominatorDepositsTotalValues
    limit: 1
  ) {
    rank
  }
}

query PendingTransaction($subspaceAccount: String, $extrinsics: [String!]) {
  consensus_accounts(where: { id: { _eq: $subspaceAccount } }) {
    id
    extrinsics(where: { hash: { _in: $extrinsics } }) {
      hash
      success
      timestamp
      name
      events(limit: 1, order_by: { id: desc }) {
        name
      }
      block {
        hash
        height
        id
      }
    }
  }
}

query ExtrinsicsSummary($first: Int!, $subspaceAccount: String) {
  consensus_extrinsics_aggregate(where: { signer: { _eq: $subspaceAccount } }) {
    aggregate {
      count
    }
  }
  extrinsics: consensus_extrinsics(
    order_by: { id: desc }
    limit: $first
    where: { signer: { _eq: $subspaceAccount } }
  ) {
    id
    hash
    success
    timestamp
    block_height
    name
  }
}

query CheckRole($subspaceAccount: String!) {
  isFarmer: consensus_rewards(
    where: {
      _or: [
        { reward_type: { _eq: "Rewards.VoteReward" } }
        { reward_type: { _eq: "Rewards.BlockReward" } }
      ]
      account_id: { _eq: $subspaceAccount }
    }
    limit: 1
  ) {
    account {
      id
    }
  }
  # TODO: fix this
  #  operator: consensus_rewards(
  #    first: 1
  #    where: { operatorOwner_eq: $subspaceAccount }
  #    orderBy: id_ASC
  #  ) {
  #    totalCount
  #  }
  #  nominator: consensus_rewards(
  #    first: 1
  #    where: { account: { id_eq: $subspaceAccount } }
  #    orderBy: id_ASC
  #  ) {
  #    totalCount
  #  }
}

query StakingSummary($first: Int!, $subspaceAccount: String) {
  staking_operators(
    order_by: { id: asc }
    limit: $first
    where: { account_id: { _eq: $subspaceAccount } }
  ) {
    id
    account_id
    domain_id
    current_total_stake
    current_total_shares
  }
  staking_operators_aggregate(
    order_by: { id: asc }
    where: { account_id: { _eq: $subspaceAccount } }
  ) {
    aggregate {
      count
    }
  }
  staking_nominators(
    order_by: { id: asc }
    limit: $first
    where: { account_id: { _eq: $subspaceAccount } }
  ) {
    id
    known_shares
    known_storage_fee_deposit
    account {
      id
    }
    operator {
      id
      account_id
      domain_id
      current_total_stake
      current_total_shares
    }
  }
  staking_nominators_aggregate(
    order_by: { id: asc }
    where: { account_id: { _eq: $subspaceAccount } }
  ) {
    aggregate {
      count
    }
  }
}
